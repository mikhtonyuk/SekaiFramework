<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sekai Framework: D:/Programming/Projects/depot/SekaiFramework/src/reflection/types/user_type.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>D:/Programming/Projects/depot/SekaiFramework/src/reflection/types/user_type.h</h1><a href="user__type_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*========================================================</span>
<a name="l00002"></a>00002 <span class="comment">* user_type.h</span>
<a name="l00003"></a>00003 <span class="comment">* @author Sergey Mikhtonyuk</span>
<a name="l00004"></a>00004 <span class="comment">* @date 28 Mar 2010</span>
<a name="l00005"></a>00005 <span class="comment">*</span>
<a name="l00006"></a>00006 <span class="comment">* Copyrights (c) Sergey Mikhtonyuk 2007-2010.</span>
<a name="l00007"></a>00007 <span class="comment">* Terms of use, copying, distribution, and modification</span>
<a name="l00008"></a>00008 <span class="comment">* are covered in accompanying LICENSE file</span>
<a name="l00009"></a>00009 <span class="comment">=========================================================*/</span>
<a name="l00010"></a>00010 <span class="preprocessor">#ifndef _USERTYPE_H__</span>
<a name="l00011"></a>00011 <span class="preprocessor"></span><span class="preprocessor">#define _USERTYPE_H__</span>
<a name="l00012"></a>00012 <span class="preprocessor"></span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="type_8h.html">types/type.h</a>&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>reflection
<a name="l00016"></a>00016 {
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="classreflection_1_1user__type.html">00019</a>         <span class="keyword">class </span><a class="code" href="reflection__fwd_8h.html#af597389e4c060fd33d39a318eae61447">REFLECTION_API</a> <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a> : <span class="keyword">public</span> <a class="code" href="classreflection_1_1type.html" title="Type information class.">type</a>
<a name="l00020"></a>00020         {
<a name="l00021"></a>00021         <span class="keyword">public</span>:
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">                #include &quot;<a class="code" href="user__type__iters_8inc.html">user_type_iters.inc</a>&quot;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025                 <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a>(<a class="code" href="group__reflection.html#ga785a0ce8ae217e39b51914f47396fc88" title="Allow at least run-time type safety for built-in types.">ETypeTag</a> tag, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keywordtype">size_t</span> size);
<a name="l00026"></a>00026 
<a name="l00027"></a>00027                 <span class="keyword">virtual</span> <span class="keywordtype">bool</span> equal(<span class="keyword">const</span> <a class="code" href="classreflection_1_1type.html" title="Type information class.">type</a>* other) <span class="keyword">const</span>;
<a name="l00028"></a><a class="code" href="classreflection_1_1user__type.html#a6c636ad640c09d9437c64b6a0aaa3c34">00028</a> 
<a name="l00030"></a>00030                 <span class="keywordtype">void</span> add_member(<span class="keyword">const</span> <a class="code" href="classreflection_1_1member.html" title="Base type of user-defined class members.">member</a>&amp; mem);
<a name="l00031"></a>00031 
<a name="l00033"></a>00033                 <span class="keywordtype">void</span> add_attribute(<span class="keyword">const</span> <a class="code" href="classreflection_1_1attribute.html" title="Attribute base class.">attribute</a>&amp; attr);
<a name="l00034"></a>00034 
<a name="l00036"></a>00036                 <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a>&amp; def(<span class="keyword">const</span> <a class="code" href="classreflection_1_1member.html" title="Base type of user-defined class members.">member</a>&amp; mem) 
<a name="l00037"></a>00037                 { 
<a name="l00038"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html">00038</a>                         add_member(mem); 
<a name="l00039"></a>00039                         <span class="keywordflow">return</span> *<span class="keyword">this</span>; 
<a name="l00040"></a>00040                 }
<a name="l00041"></a>00041 
<a name="l00043"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a46bbf8c48373eb457fce0d0d5dff9cf0">00043</a>                 <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a>&amp; def(<span class="keyword">const</span> <a class="code" href="classreflection_1_1attribute.html" title="Attribute base class.">attribute</a>&amp; a) 
<a name="l00044"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a462b9d9919bf9044c83a7af953c3f1d3">00044</a>                 { 
<a name="l00045"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a62ba6dd72ebe059285b0cece322789c4">00045</a>                         add_attribute(a); 
<a name="l00046"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#ac29e404aaa98f02975b54a24400ce021">00046</a>                         <span class="keywordflow">return</span> *<span class="keyword">this</span>; 
<a name="l00047"></a>00047                 }
<a name="l00048"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a906d89e5f08e31f4a0ba7628d7360c93">00048</a> 
<a name="l00050"></a>00050 
<a name="l00051"></a>00051                 <span class="keyword">static</span> <span class="keywordtype">size_t</span> calculate_offset(<span class="keyword">const</span> <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a>&amp; derived, <span class="keyword">const</span> <a class="code" href="classreflection_1_1user__type.html" title="User-defined type class.">user_type</a>&amp; base);
<a name="l00052"></a>00052 
<a name="l00053"></a>00053         <span class="keyword">private</span>:
<a name="l00054"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a5b97a1d77a7f87f329fc68e2fbdf0496">00054</a> 
<a name="l00055"></a>00055                 <span class="keyword">virtual</span> <span class="keywordtype">size_t</span> _attribute_count() <span class="keyword">const</span>;
<a name="l00056"></a>00056                 <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classreflection_1_1attribute.html" title="Attribute base class.">attribute</a>* _get_attribute(<span class="keywordtype">size_t</span> i) <span class="keyword">const</span>;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058                 <span class="keywordtype">size_t</span> _member_count() <span class="keyword">const</span>;
<a name="l00059"></a>00059                 <a class="code" href="classreflection_1_1member.html" title="Base type of user-defined class members.">member</a>* _get_member(<span class="keywordtype">size_t</span> i) <span class="keyword">const</span>;
<a name="l00060"></a>00060                 <span class="keywordtype">size_t</span> _find_member(<span class="keyword">const</span> <span class="keywordtype">char</span>* name) <span class="keyword">const</span>;
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a74909a85b2c03812ff0cc6faa2e65eeb">00062</a>                 <span class="keywordtype">void</span> traverse_rec(<a class="code" href="structreflection_1_1user__type_1_1hierarchy__traverser.html" title="Implement this interface to traverse hierarchy of types.">hierarchy_traverser</a>&amp; tr, <span class="keywordtype">size_t</span> depth) <span class="keyword">const</span>;
<a name="l00063"></a>00063 
<a name="l00064"></a>00064         <span class="keyword">private</span>:
<a name="l00065"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#ae90aa3da660ab9774b59be1f6f3b604a">00065</a>                 <span class="keyword">class </span><a class="code" href="classreflection_1_1user__type_1_1user__type__impl.html">user_type_impl</a>;
<a name="l00066"></a>00066                 <a class="code" href="classreflection_1_1user__type_1_1user__type__impl.html">user_type_impl</a>* m_impl;
<a name="l00067"></a>00067         };
<a name="l00068"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a2ed310749b1d685cefc5c705c2928712">00068</a> 
<a name="l00069"></a>00069 } <span class="comment">// namespace</span>
<a name="l00070"></a>00070 
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="preprocessor">#define reflect_user(clas, name, tag)                                                                                   \</span>
<a name="l00074"></a>00074 <span class="preprocessor">namespace reflection { namespace detail {                                                                               \</span>
<a name="l00075"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a544462c43a3702425db798681c340023">00075</a> <span class="preprocessor">template&lt;&gt; struct type_desc&lt;clas&gt; {                                                                                             \</span>
<a name="l00076"></a>00076 <span class="preprocessor">        user_type* get_type() {                                                                                                         \</span>
<a name="l00077"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a7a59ccbde0b3c95decd46e0381f79e39">00077</a> <span class="preprocessor">                typedef clas Class;                                                                                                             \</span>
<a name="l00078"></a>00078 <span class="preprocessor">                static bool is_init = false;                                                                                    \</span>
<a name="l00079"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#ae6882c13eb146bd7807d89065ce07ec9">00079</a> <span class="preprocessor">                static user_type t(tag, name, sizeof(clas));                                                    \</span>
<a name="l00080"></a>00080 <span class="preprocessor">                if(!is_init) {                                                                                                                  \</span>
<a name="l00081"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#aca7eeb5ff33545863c64d6611448226a">00081</a> <span class="preprocessor">                        is_init = true;                                                                                                         \</span>
<a name="l00082"></a>00082 <span class="preprocessor">                        t</span>
<a name="l00083"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a4567c22d02f864c5e8a58ea8f96a04a4">00083</a> <span class="preprocessor"></span>
<a name="l00085"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a98dc6e56f49f07eec465809c8d159bb3">00085</a> 
<a name="l00086"></a>00086 <span class="preprocessor">#define reflect_class(clas, name) reflect_user(clas, name, T_CLASS)</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span><span class="preprocessor">#define reflect_struct(clas, name) reflect_user(clas, name, T_STRUCT)</span>
<a name="l00088"></a>00088 <span class="preprocessor"></span><span class="preprocessor">#define reflect_enum(clas, name) reflect_user(clas, name, T_ENUM)</span>
<a name="l00089"></a>00089 <span class="preprocessor"></span>
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a0de525be705d5ba672d3909bfce447ea">00092</a> <span class="preprocessor">#define def_ctor_custom(_create, _destroy)                                                                              \</span>
<a name="l00093"></a>00093 <span class="preprocessor">        def(construct_attribute::create(                                                                                        \</span>
<a name="l00094"></a>00094 <span class="preprocessor">        type_of(_create),                                                                                                                       \</span>
<a name="l00095"></a>00095 <span class="preprocessor">        MakeDelegate(_create),                                                                                                          \</span>
<a name="l00096"></a>00096 <span class="preprocessor">        _destroy))</span>
<a name="l00097"></a>00097 <span class="preprocessor"></span>
<a name="l00098"></a>00098 <span class="preprocessor">#define def_ctor_alloc(alloc, ...)                                                                                              \</span>
<a name="l00099"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a38ea4e1eca40aff556fdbd1a14a0067a">00099</a> <span class="preprocessor">        def(construct_attribute::create(                                                                                        \</span>
<a name="l00100"></a>00100 <span class="preprocessor">        type_of(&amp;type_ctor&lt;Class, alloc, ## __VA_ARGS__&gt;),                                                      \</span>
<a name="l00101"></a>00101 <span class="preprocessor">        MakeDelegate(&amp;type_ctor&lt;Class, alloc, ## __VA_ARGS__&gt;),                                         \</span>
<a name="l00102"></a>00102 <span class="preprocessor">        &amp;type_destructor&lt;Class, alloc&gt;))</span>
<a name="l00103"></a>00103 <span class="preprocessor"></span>
<a name="l00104"></a>00104 <span class="preprocessor">#define def_create_inst(...)                                                                                                    \</span>
<a name="l00105"></a>00105 <span class="preprocessor">        def(construct_attribute::create(                                                                                        \</span>
<a name="l00106"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a10426df2b582d7c84a73b8645a396f5b">00106</a> <span class="preprocessor">        type_of(&amp;type_create_inst&lt;Class, ## __VA_ARGS__&gt;),                                                      \</span>
<a name="l00107"></a>00107 <span class="preprocessor">        MakeDelegate(&amp;type_create_inst&lt;Class, ## __VA_ARGS__&gt;),                                         \</span>
<a name="l00108"></a>00108 <span class="preprocessor">        &amp;type_destroy_inst&lt;Class&gt;))</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>
<a name="l00110"></a>00110 <span class="preprocessor">#define def_ctor(...)                                                                                                                   \</span>
<a name="l00111"></a>00111 <span class="preprocessor">        def_ctor_alloc(module::new_allocator, ## __VA_ARGS__)</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="classreflection_1_1user__type_1_1member__iterator.html#a4bfe365354dde97b86fe9f66bfdcf2a5">00114</a> <span class="preprocessor">#define def_method(name, func)                                                                                                  \</span>
<a name="l00115"></a>00115 <span class="preprocessor">        def(method_member::create(name, MakeDelegate(static_cast&lt;Class*&gt;(0), &amp;Class::func), type_of(&amp;Class::func)))</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a>00117 <span class="preprocessor">#define def_accessor(name, fget, fset)                                                                                  \</span>
<a name="l00118"></a>00118 <span class="preprocessor">        def(accessor_member::create(name,                                                                                       \</span>
<a name="l00119"></a>00119 <span class="preprocessor">        MakeDelegate(static_cast&lt;Class*&gt;(0), &amp;Class::fget), type_of(&amp;Class::fget),      \</span>
<a name="l00120"></a>00120 <span class="preprocessor">        MakeDelegate(static_cast&lt;Class*&gt;(0), &amp;Class::fset), type_of(&amp;Class::fset)))</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>
<a name="l00122"></a>00122 <span class="preprocessor">#define def_accessor_ro(name, fget)                                                                                             \</span>
<a name="l00123"></a>00123 <span class="preprocessor">        def(accessor_member::create(name,                                                                                       \</span>
<a name="l00124"></a>00124 <span class="preprocessor">        MakeDelegate(static_cast&lt;Class*&gt;(0), &amp;Class::fget), type_of(&amp;Class::fget)))</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>
<a name="l00126"></a>00126 <span class="preprocessor">#define def_enum(name, value) def(enumeration_member(name, value))</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>
<a name="l00128"></a><a class="code" href="classreflection_1_1user__type.html#ab5fca0667008676649af0a409cdddb24">00128</a> <span class="preprocessor">#define def_base(base) def(base_type(type_of&lt;base&gt;(), classoffset&lt;base, Class&gt;()))</span>
<a name="l00129"></a><a class="code" href="classreflection_1_1user__type.html#a04d96b7e84eef43f349bd93e854484a5">00129</a> <span class="preprocessor"></span>
<a name="l00130"></a>00130 <span class="preprocessor">#define def_parsable() def(parsing_attribute_t&lt;Class&gt;())</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="preprocessor">#define end_reflection() ;}return &amp;t;}};}}</span>
<a name="l00135"></a>00135 <span class="preprocessor"></span>
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="preprocessor">#endif //_USERTYPE_H__</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Wed Apr 28 21:26:19 2010 for Sekai Framework by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
